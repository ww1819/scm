<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.scm.system.mapper.HospitalSupplierMapper">
    
    <resultMap type="HospitalSupplier" id="HospitalSupplierResult">
        <id     property="relationId"        column="relation_id"        />
        <result property="hospitalId"        column="hospital_id"        />
        <result property="supplierId"        column="supplier_id"        />
        <result property="bindStatus"        column="bind_status"        />
        <result property="bindTime"         column="bind_time"          />
        <result property="bindBy"           column="bind_by"            />
        <result property="unbindTime"       column="unbind_time"        />
        <result property="unbindBy"         column="unbind_by"          />
        <result property="status"           column="status"             />
        <result property="createBy"         column="create_by"          />
        <result property="createTime"       column="create_time"       />
        <result property="updateBy"         column="update_by"         />
        <result property="updateTime"       column="update_time"        />
        <result property="remark"           column="remark"             />
    </resultMap>
    
    <sql id="selectHospitalSupplierVo">
        select relation_id, hospital_id, supplier_id, bind_status, bind_time, bind_by,
               unbind_time, unbind_by, status, create_by, create_time, update_by, update_time, remark
        from scm_hospital_supplier
    </sql>
    
    <select id="selectHospitalSupplierList" parameterType="HospitalSupplier" resultMap="HospitalSupplierResult">
        <include refid="selectHospitalSupplierVo"/>
        <where>
            <if test="hospitalId != null">
                AND hospital_id = #{hospitalId}
            </if>
            <if test="supplierId != null">
                AND supplier_id = #{supplierId}
            </if>
            <if test="bindStatus != null and bindStatus != ''">
                AND bind_status = #{bindStatus}
            </if>
            <if test="status != null and status != ''">
                AND status = #{status}
            </if>
        </where>
        order by create_time desc
    </select>
    
    <select id="selectHospitalSupplierById" parameterType="Long" resultMap="HospitalSupplierResult">
        <include refid="selectHospitalSupplierVo"/>
        where relation_id = #{relationId}
    </select>
    
    <select id="selectHospitalSupplierBySupplierId" parameterType="Long" resultMap="HospitalSupplierResult">
        <include refid="selectHospitalSupplierVo"/>
        where supplier_id = #{supplierId} and status = '0'
    </select>
    
    <insert id="insertHospitalSupplier" parameterType="HospitalSupplier" useGeneratedKeys="true" keyProperty="relationId">
        insert into scm_hospital_supplier(
            <if test="hospitalId != null">hospital_id,</if>
            <if test="supplierId != null">supplier_id,</if>
            <if test="bindStatus != null and bindStatus != ''">bind_status,</if>
            <if test="bindTime != null">bind_time,</if>
            <if test="bindBy != null and bindBy != ''">bind_by,</if>
            <if test="unbindTime != null">unbind_time,</if>
            <if test="unbindBy != null and unbindBy != ''">unbind_by,</if>
            <if test="status != null and status != ''">status,</if>
            <if test="remark != null and remark != ''">remark,</if>
            <if test="createBy != null and createBy != ''">create_by,</if>
            create_time
        )values(
            <if test="hospitalId != null">#{hospitalId},</if>
            <if test="supplierId != null">#{supplierId},</if>
            <if test="bindStatus != null and bindStatus != ''">#{bindStatus},</if>
            <if test="bindTime != null">#{bindTime},</if>
            <if test="bindBy != null and bindBy != ''">#{bindBy},</if>
            <if test="unbindTime != null">#{unbindTime},</if>
            <if test="unbindBy != null and unbindBy != ''">#{unbindBy},</if>
            <if test="status != null and status != ''">#{status},</if>
            <if test="remark != null and remark != ''">#{remark},</if>
            <if test="createBy != null and createBy != ''">#{createBy},</if>
            sysdate()
        )
    </insert>
    
    <update id="updateHospitalSupplier" parameterType="HospitalSupplier">
        update scm_hospital_supplier
        <set>
            <if test="hospitalId != null">hospital_id = #{hospitalId},</if>
            <if test="supplierId != null">supplier_id = #{supplierId},</if>
            <if test="bindStatus != null and bindStatus != ''">bind_status = #{bindStatus},</if>
            <if test="bindTime != null">bind_time = #{bindTime},</if>
            <if test="bindBy != null and bindBy != ''">bind_by = #{bindBy},</if>
            <if test="unbindTime != null">unbind_time = #{unbindTime},</if>
            <if test="unbindBy != null and unbindBy != ''">unbind_by = #{unbindBy},</if>
            <if test="status != null and status != ''">status = #{status},</if>
            <if test="remark != null and remark != ''">remark = #{remark},</if>
            <if test="updateBy != null and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate()
        </set>
        where relation_id = #{relationId}
    </update>
    
    <delete id="deleteHospitalSupplierById" parameterType="Long">
        delete from scm_hospital_supplier where relation_id = #{relationId}
    </delete>
    
    <delete id="deleteHospitalSupplierByIds" parameterType="String">
        delete from scm_hospital_supplier where relation_id in
        <foreach item="relationId" collection="array" open="(" separator="," close=")">
            #{relationId}
        </foreach>
    </delete>
    
    <delete id="deleteHospitalSupplierBySupplierId" parameterType="Long">
        delete from scm_hospital_supplier where supplier_id = #{supplierId}
    </delete>
</mapper>

