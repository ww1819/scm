<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.scm.system.mapper.HospitalMapper">
    
    <resultMap type="Hospital" id="HospitalResult">
        <id     property="hospitalId"        column="hospital_id"        />
        <result property="hospitalCode"      column="hospital_code"      />
        <result property="hospitalName"      column="hospital_name"      />
        <result property="hospitalShortName" column="hospital_short_name" />
        <result property="hospitalLevel"     column="hospital_level"     />
        <result property="province"          column="province"           />
        <result property="city"              column="city"               />
        <result property="district"          column="district"           />
        <result property="address"          column="address"            />
        <result property="contactPerson"     column="contact_person"     />
        <result property="contactPhone"     column="contact_phone"      />
        <result property="email"            column="email"              />
        <result property="status"           column="status"             />
        <result property="delFlag"          column="del_flag"           />
        <result property="createBy"         column="create_by"          />
        <result property="createTime"       column="create_time"        />
        <result property="updateBy"         column="update_by"          />
        <result property="updateTime"       column="update_time"        />
        <result property="remark"           column="remark"             />
    </resultMap>
    
    <sql id="selectHospitalVo">
        select hospital_id, hospital_code, hospital_name, hospital_short_name, hospital_level,
               province, city, district, address, contact_person, contact_phone, email,
               status, del_flag, create_by, create_time, update_by, update_time, remark
        from scm_hospital
    </sql>
    
    <select id="selectHospitalList" parameterType="Hospital" resultMap="HospitalResult">
        <include refid="selectHospitalVo"/>
        <where>
            del_flag = '0'
            <if test="hospitalCode != null and hospitalCode != ''">
                AND hospital_code like concat('%', #{hospitalCode}, '%')
            </if>
            <if test="hospitalName != null and hospitalName != ''">
                AND hospital_name like concat('%', #{hospitalName}, '%')
            </if>
            <if test="status != null and status != ''">
                AND status = #{status}
            </if>
            <if test="province != null and province != ''">
                AND province = #{province}
            </if>
            <if test="city != null and city != ''">
                AND city = #{city}
            </if>
        </where>
        order by create_time desc
    </select>
    
    <select id="selectHospitalById" parameterType="Long" resultMap="HospitalResult">
        <include refid="selectHospitalVo"/>
        where hospital_id = #{hospitalId} and del_flag = '0'
    </select>
    
    <select id="checkHospitalCodeUnique" parameterType="String" resultMap="HospitalResult">
        <include refid="selectHospitalVo"/>
        where hospital_code = #{hospitalCode} and del_flag = '0' limit 1
    </select>
    
    <insert id="insertHospital" parameterType="Hospital" useGeneratedKeys="true" keyProperty="hospitalId">
        insert into scm_hospital(
            <if test="hospitalCode != null and hospitalCode != ''">hospital_code,</if>
            <if test="hospitalName != null and hospitalName != ''">hospital_name,</if>
            <if test="hospitalShortName != null and hospitalShortName != ''">hospital_short_name,</if>
            <if test="hospitalLevel != null and hospitalLevel != ''">hospital_level,</if>
            <if test="province != null and province != ''">province,</if>
            <if test="city != null and city != ''">city,</if>
            <if test="district != null and district != ''">district,</if>
            <if test="address != null and address != ''">address,</if>
            <if test="contactPerson != null and contactPerson != ''">contact_person,</if>
            <if test="contactPhone != null and contactPhone != ''">contact_phone,</if>
            <if test="email != null and email != ''">email,</if>
            <if test="status != null and status != ''">status,</if>
            <if test="remark != null and remark != ''">remark,</if>
            <if test="createBy != null and createBy != ''">create_by,</if>
            create_time
        )values(
            <if test="hospitalCode != null and hospitalCode != ''">#{hospitalCode},</if>
            <if test="hospitalName != null and hospitalName != ''">#{hospitalName},</if>
            <if test="hospitalShortName != null and hospitalShortName != ''">#{hospitalShortName},</if>
            <if test="hospitalLevel != null and hospitalLevel != ''">#{hospitalLevel},</if>
            <if test="province != null and province != ''">#{province},</if>
            <if test="city != null and city != ''">#{city},</if>
            <if test="district != null and district != ''">#{district},</if>
            <if test="address != null and address != ''">#{address},</if>
            <if test="contactPerson != null and contactPerson != ''">#{contactPerson},</if>
            <if test="contactPhone != null and contactPhone != ''">#{contactPhone},</if>
            <if test="email != null and email != ''">#{email},</if>
            <if test="status != null and status != ''">#{status},</if>
            <if test="remark != null and remark != ''">#{remark},</if>
            <if test="createBy != null and createBy != ''">#{createBy},</if>
            sysdate()
        )
    </insert>
    
    <update id="updateHospital" parameterType="Hospital">
        update scm_hospital
        <set>
            <if test="hospitalCode != null and hospitalCode != ''">hospital_code = #{hospitalCode},</if>
            <if test="hospitalName != null and hospitalName != ''">hospital_name = #{hospitalName},</if>
            <if test="hospitalShortName != null and hospitalShortName != ''">hospital_short_name = #{hospitalShortName},</if>
            <if test="hospitalLevel != null and hospitalLevel != ''">hospital_level = #{hospitalLevel},</if>
            <if test="province != null and province != ''">province = #{province},</if>
            <if test="city != null and city != ''">city = #{city},</if>
            <if test="district != null and district != ''">district = #{district},</if>
            <if test="address != null and address != ''">address = #{address},</if>
            <if test="contactPerson != null and contactPerson != ''">contact_person = #{contactPerson},</if>
            <if test="contactPhone != null and contactPhone != ''">contact_phone = #{contactPhone},</if>
            <if test="email != null and email != ''">email = #{email},</if>
            <if test="status != null and status != ''">status = #{status},</if>
            <if test="remark != null and remark != ''">remark = #{remark},</if>
            <if test="updateBy != null and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate()
        </set>
        where hospital_id = #{hospitalId}
    </update>
    
    <update id="deleteHospitalById" parameterType="Long">
        update scm_hospital set del_flag = '2' where hospital_id = #{hospitalId}
    </update>
    
    <update id="deleteHospitalByIds" parameterType="String">
        update scm_hospital set del_flag = '2' where hospital_id in
        <foreach item="hospitalId" collection="array" open="(" separator="," close=")">
            #{hospitalId}
        </foreach>
    </update>
</mapper>

